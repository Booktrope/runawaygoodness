if(!RunawayGoodness){var RunawayGoodness={}}RunawayGoodness.SubscribeForm=function(){this.rg_block=null;this.form=null;this.genre_select=null;this.email_input=null;this.submit_button=null;this.submitted_form=false;this.attempts=0};RunawayGoodness.SubscribeForm.buildForm=function(){if(isNaN(this.attempts)){this.attempts=0}this.submitted_form=false;this.rg_block=$("#rg-signupblock");if(typeof this.rg_block!=="undefined"){this.rg_block.addClass("rg-signupblock").css("background","black").css("color","white").css("font-family","'Lato', sans-serif").css("font-size","14pt").css("text-align","center").css("margin","4px").css("padding","5px");var e=document.createElement("p");$(e).html("Sign up for Runaway Goodness to receive info on free and discounted books! It's 100% free!");this.rg_block.append(e);this.form=document.createElement("form");this.form.setAttribute("id","rg-signupform");this.form.setAttribute("name","rg-signupform");this.form.setAttribute("class","rg-signupform");if(typeof rg_showGenres!=="undefined"&&rg_showGenres==true){var f='[{"name":"Romance","value":"d7adefae40"},{"name":"Women\'s Contemporary Fiction","value":"044e00b73e"},{"name":"Chick Lit","value":"71fff6c086"},{"name":"Young Adult","value":"214df279b6"},{"name":"New Adult","value":"715b34ff18"},{"name":"Romantic Suspense","value":"c0f401a02f"},{"name":"Horror","value":"1526319864"},{"name":"Literary Fiction","value":"25862f090e"},{"name":"Self Help","value":"f870639656"},{"name":"Thriller","value":"6c0e8d58fd"},{"name":"Humor","value":"b5c00b76cf"},{"name":"Christian","value":"7e5b03badc"},{"name":"Science Fiction","value":"a8f230c4c1"},{"name":"Historical Romance","value":"7a463d765b"},{"name":"Paranormal","value":"1b4528eaf1"},{"name":"Mid-grade","value":"08d41db534"},{"name":"Fantasy","value":"5ef2b04121"},{"name":"Memoir","value":"cdc5a72605"},{"name":"LGBT","value":"c3103e3a92"},{"name":"Mystery","value":"2f5b7db69f"},{"name":"Business","value":"48bfe6da8a"},{"name":"Creative Writing","value":"8535224d0a"}]';var d=jQuery.parseJSON(f);var g=document.createElement("p");var c=document.createElement("select");this.genre_select=c;this.genre_select.setAttribute("id","rg-genre");this.genre_select.setAttribute("name","rg-genre");this.genre_select.setAttribute("class","rg-genre");$.each(d,function(i,h){var j=document.createElement("option");j.setAttribute("value",h.value+":"+h.name);$(j).html(h.name);c.appendChild(j)});g.appendChild(this.genre_select);this.form.appendChild(g)}var b=document.createElement("p");this.email_input=document.createElement("input");this.email_input.setAttribute("id","rg-email");this.email_input.setAttribute("name","rg-email");this.email_input.setAttribute("class","rg-email");this.email_input.setAttribute("placeholder","Enter your email address");$(this.email_input).css("width","200px").css("padding","2px");b.appendChild(this.email_input);var a=document.createElement("p");this.submit_button=document.createElement("button");this.submit_button.setAttribute("id","rg-signupbutton");this.submit_button.setAttribute("name","rg-signupbutton");this.submit_button.setAttribute("class","rg-signupbutton");this.submit_button.setAttribute("type","button");$(this.submit_button).html("GET YOUR FREE BOOK");$(this.submit_button).css("background-color","#aa0000").css("color","white").css("border","none").css("border-radius","3px").css("padding","7px");$(this.submit_button).click(function(){RunawayGoodness.SubscribeForm.subscribeCall()});a.appendChild(this.submit_button);this.form.appendChild(b);this.form.appendChild(a);this.rg_block.append(this.form)}};RunawayGoodness.SubscribeForm.subscribeCall=function(){if(this.submitted_form==true){return}var d=$("#rg-email").val();if(typeof d=="undefined"||d==""||(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d)==false)){return}var a="";if(typeof rg_showGenres!=="undefined"&&rg_showGenres==true){a=$("[name=rg-genre]").find("option:selected").val()}if(typeof this.genre_select!=="undefined"&&this.genre_select!==null){$(this.genre_select).prop("disabled",true)}$(this.email_input).prop("disabled",true);var c="";if(typeof rg_mySite!=="undefined"&&rg_mySite!==""){c=rg_mySite}var b=JSON.stringify({email:d,genre:a,source:c});RunawayGoodness.SubscribeForm.showSubmissionInProgress();$.ajax({type:"POST",url:"https://runawaygoodness.com/wp-json/rg/v1/subscribe/",dataType:"json",contentType:"application/json",timeout:30000,data:b,success:function(e){RunawayGoodness.SubscribeForm.handleSubmissionSuccess(e)},error:function(e){RunawayGoodness.SubscribeForm.handleSubmissionFailure(e)}})};RunawayGoodness.SubscribeForm.clearBlock=function(){$(this.rg_block).html("");this.form=null;this.genre_select=null;this.email_input=null;this.submit_button=null};RunawayGoodness.SubscribeForm.showSubmissionInProgress=function(){RunawayGoodness.SubscribeForm.clearBlock();var b=document.createElement("p");$(b).html("<p>Signing you up!  Get ready for some great deals straight to your Inbox!</p>");var a=$(document.createElement("div")).css("text-align","center").css("margin","10px");var c=document.createElement("img");$(c).attr("src","https://runawaygoodness.com/wp-content/plugins/rg-mailchimp-connect/assets/rg-widget-busy.gif");a.append(c);this.rg_block.append(b);this.rg_block.append(a)};RunawayGoodness.SubscribeForm.handleSubmissionSuccess=function(d){this.submitted_form=true;RunawayGoodness.SubscribeForm.clearBlock();if((d.code&&d.result_code<100)||(d.errors&&d.errors==true)){RunawayGoodness.SubscribeForm.handleSubmissionFailure(d)}else{var c=$(document.createElement("div")).css("font-size","10pt").css("text-align","left").css("margin","4px").css("padding","5px");var e=document.createElement("p");$(e).html("Thank you for signing up for the Runaway Goodness newsletter.");var b=$(e).clone();$(b).html("Since you donâ€™t want to miss out on the free and discounted books, now would be an awesome time to add books@runawaygoodness.com to your email address book.");var a=$(e).clone();$(a).html("It looks like you're already subscribed with this address!");var f=$(e).clone();$(f).html('You can <a href="'+d.update_url+'">update your subscription</a> by going <a href="'+d.update_url+'">here.</a>');if(d.result_code&&d.result_code==110){$(c).append(a)}else{if(d.result_code&&d.result_code==100){$(c).append(e);$(c).append(b)}}$(c).append(f);this.rg_block.append(c)}};RunawayGoodness.SubscribeForm.handleSubmissionFailure=function(a){this.attempts+=1;RunawayGoodness.SubscribeForm.clearBlock();if(a.message){console.log(a.message)}var b=document.createElement("p");if(this.attempts<=2){$(b).html("Uh-oh, something went wrong!  Do you want to try again?").css("font-size","10pt");this.rg_block.append(b);var c=document.createElement("button");c.setAttribute("id","rg-resubmit");c.setAttribute("name","rg-resubmit");c.setAttribute("class","rg-resubmit");c.setAttribute("type","button");$(c).html("Try Again!");$(c).css("background-color","#aa0000").css("color","white").css("border","none").css("border-radius","3px").css("padding","7px");$(c).click(function(){RunawayGoodness.SubscribeForm.clearBlock();RunawayGoodness.SubscribeForm.buildForm()});this.rg_block.append(c)}else{$(b).html('We\'re not having much luck.  Try subscribing directly from <a href="https://runawaygoodness.com/">runawaygoodness.com</a>.').css("font-size","10pt");this.rg_block.append(b)}};$(document).ready(function(){RunawayGoodness.SubscribeForm.buildForm();$(window).keydown(function(a){if(a.keyCode==13){a.preventDefault();return false}})});